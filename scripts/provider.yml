name: aws
runtime: nodejs20.x
stage: dev
region: us-east-1
memorySize: 128
timeout: 3

iamRoleStatements:
  - Effect: "Allow"
    Action:
      - "sns:Publish"
    Resource:
      - arn:aws:sns:${aws:region}:${aws:accountId}:${self:service}-${self:provider.stage}-topic

  - Effect: "Allow"
    Action:
      - "sqs:ReceiveMessage"
      - "sqs:DeleteMessage"
      - "sqs:GetQueueAttributes"
    Resource:
      - !GetAtt SqsPe.Arn

  - Effect: "Allow"
    Action:
      - "events:PutEvents"
    Resource: "*"

  - Effect: "Allow"
    Action:
      - "sqs:SendMessage"
    Resource:
      - !GetAtt SqsArcangel.Arn

  - Effect: Allow
    Resource: "*"
    Action:
      - dynamodb:Query
      - dynamodb:PutItem
      - dynamodb:UpdateItem
      - dynamodb:GetItem
      - dynamodb:DeleteItem